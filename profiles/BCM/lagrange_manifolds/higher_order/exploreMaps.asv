%A script for exploring the behaviors of the monodromy matrix map and the
%quadratic monodromy tensor map.

clear xlin

linear = @(x)phi{1}(:,:,3)*x;

numIter = 2;
pointDensity = 40;

xlin(:,1,:) = threesphere(pointDensity);
xquad(:,1,:) = threesphere(pointDensity);

for i = 2:numIter
    xlin(:,i,:) = linear(squeeze(xlin(:,i-1,:)));
    xlin(:,i,:) = quadrat(squeeze(xquad(:,i-1,:)));
end

xlinr = reshape(x,4,[]);

cplot(xlinr,c,'.')